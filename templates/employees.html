<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Employees</title>
    <style>
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #ddd; padding: 8px; }
      th { background: #f2f2f2; }
    </style>
  </head>
  <body>
    {% include '_header.html' %}
    <h1>Employees</h1>
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul style="color: red; list-style-type: none; padding:0;">
          {% for m in messages %}
            <li>{{ m }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}

    {% if g.user and g.user.get('role') == 'admin' %}
      <p><a href="{{ url_for('employees.add_employee') }}">Add Employee</a></p>
    {% endif %}

    <table>
      <thead>
        <tr><th>SSN</th><th>Full Name</th><th>Address</th><th>Salary</th><th>Dno</th>{% if g.user and g.user.get('role') == 'admin' %}<th>Actions</th>{% endif %}</tr>
      </thead>
      <tbody>
        {% for e in employees %}
        <tr>
          <td>{{ e.ssn }}</td>
          <td>{{ e.full_name }}</td>
          <td>{{ e.address }}</td>
          <td style="text-align:right">{{ e.salary }}</td>
          <td style="text-align:right">{{ e.dno }}</td>
          {% if g.user and g.user.get('role') == 'admin' %}
          <td>
            <a href="{{ url_for('employees.edit_employee', ssn=e.ssn) }}">Edit</a>
            | <form method="post" action="{{ url_for('employees.delete_employee', ssn=e.ssn) }}" style="display:inline" onsubmit="return confirm('Delete this employee?');">
                <button type="submit">Delete</button>
              </form>
          </td>
          {% endif %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </body>
</html>
