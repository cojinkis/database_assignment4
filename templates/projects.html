<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Projects</title>
    <style>
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #ddd; padding: 8px; }
      th { background: #f2f2f2; }
      a.sort { text-decoration: none; font-size: 0.9em; margin-left: 6px; }
    </style>
  </head>
  <body>
    <h1>Projects – Portfolio Summary</h1>
    <table>
      <thead>
        <tr>
          <th>Project Name</th>
          <th>Owning Department</th>
          <th>
            Headcount
            {% for dir,label in [('asc','↑'),('desc','↓')] %}
              <a class="sort" href="?sort_by=headcount&order={{dir}}">{{label}}</a>
            {% endfor %}
          </th>
          <th>
            Total Hours
            {% for dir,label in [('asc','↑'),('desc','↓')] %}
              <a class="sort" href="?sort_by=total_hours&order={{dir}}">{{label}}</a>
            {% endfor %}
          </th>
        </tr>
      </thead>
      <tbody>
        {% for p in projects %}
        <tr>
          <td><a href="/projects/{{p.pnumber}}">{{p.project_name}}</a></td>
          <td>{{p.department_name or 'N/A'}}</td>
          <td style="text-align:right">{{p.headcount}}</td>
          <td style="text-align:right">{{p.total_hours}}</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </body>
</html>
